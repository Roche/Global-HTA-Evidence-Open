<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STEM compatibility • flexsurvPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="STEM compatibility">
<meta property="og:description" content="flexsurvPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-181075487-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-181075487-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsurvPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.02</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/flexsurvPlus/docs/index.html">flexsurvPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/gemtcPlus/docs/index.html">gemtcPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/MAIC/docs/index.html">MAIC</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/rpsftmPlus/docs/index.html">rpsftmPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/descem/docs/index.html">descem</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Roche/Global-HTA-Evidence-Open/tree/master/Rpackages/flexsurvPlus">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="STEM_compatibility_files/header-attrs-2.5/header-attrs.js"></script><script src="STEM_compatibility_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="STEM_compatibility_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="STEM_compatibility_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>STEM compatibility</h1>
                        <h4 class="author">Roche</h4>
            
            <h4 class="date">2021-08-03</h4>
      
      
      <div class="hidden name"><code>STEM_compatibility.Rmd</code></div>

    </div>

    
    
<style type="text/css">

body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
  font-size: 10px;
}
h1.title {
  font-size: 38px;
}
h1 { /* Header 1 */
  font-size: 28px;
  }
h2 { /* Header 2 */
    font-size: 22px;
}
h3 { /* Header 3 */
  font-size: 18px;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette describes the use of the <tt>convSTEM</tt> function which enables backwards compatibility with STEM economic models which use an alternative formulation of parametric survival models. For most users this vignette can be safely ignored. The following packages are required to run this example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flexsurvPlus</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></pre></div>
<div id="read-in-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-the-data" class="anchor"></a>Read in the data</h2>
<p>To perform survival analyses, patient level data is required for the survival endpoints.</p>
<p>This example uses a standard simulated data set (adtte). There is no standard naming that is needed for this package however, there are some set variables that are needed:</p>
<ul>
<li>Time - a numeric variable</li>
<li>Event - a binary variable (event=1, censor=0)</li>
</ul>
<p>In this example, we use only progression-free survival (PFS).</p>
<div class="sourceCode" id="cb2"><pre class="downlit">


<span class="co"># simulate data with a medium correlation between PFS &amp; OS on the patient level</span>
<span class="va">adtte</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_adtte.html">sim_adtte</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">2020</span>, <span class="co"># for reproducibility</span>
                   rho <span class="op">=</span> <span class="fl">0.6</span> <span class="co"># defines a correlation on underlying survival times</span>
                   <span class="op">)</span> 

<span class="co"># subset PFS data and rename</span>
<span class="va">PFS_data</span> <span class="op">&lt;-</span> <span class="va">adtte</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span><span class="op">==</span><span class="st">"PFS"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">ARMCD</span>,
            <span class="va">AVAL</span>,
            event <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">CNSR</span> <span class="co">#needs to be coded as 1 for event</span>
  <span class="op">)</span></pre></div>
</div>
</div>
<div id="fitting-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-models" class="anchor"></a>Fitting models</h1>
<p>This section uses <tt>runPSM</tt> as described in other vignettes to estimate survival models. As described in other vignettes <tt>flexsurvPlus</tt> primarily uses bootstrapping to handle uncertainty with the <tt>bootPSM</tt> function in conjunction with <tt>boot</tt>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="co"># For speed only 4 models are considered for this example but </span>
<span class="co"># all models could be considered</span>

<span class="va">psm_PFS_expweib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">PFS_data</span>,
                          time_var <span class="op">=</span> <span class="st">"AVAL"</span>,
                          event_var <span class="op">=</span><span class="st">"event"</span>,
                          model.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, 
                                         <span class="st">"Separate"</span><span class="op">)</span>,
                     distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>,
                               <span class="st">'weibull'</span><span class="op">)</span>,
                     strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
                     int_name <span class="op">=</span> <span class="st">"A"</span>,
                     ref_name <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span>


<span class="co"># Apply bootstrapping for illustration 100 samples are taken</span>
<span class="co"># In practice a larger number maybe preferable.</span>

<span class="va">psm_boot_PFS_expweib</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span>statistic <span class="op">=</span> <span class="va">bootPSM</span>, <span class="co"># bootstrap function</span>
                              R <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of bootstrap samples</span>
                              data <span class="op">=</span> <span class="va">PFS_data</span>, <span class="co"># the dataset</span>
                              time_var <span class="op">=</span> <span class="st">"AVAL"</span>, <span class="co"># the time variable</span>
                              event_var <span class="op">=</span> <span class="st">"event"</span>, <span class="co"># the event variable coded as 1 for event</span>
                              model.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, 
                                             <span class="st">"Separate"</span><span class="op">)</span>, 
                              distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>, <span class="st">'weibull'</span><span class="op">)</span>,
                              int_name <span class="op">=</span> <span class="st">"A"</span>,
                              ref_name <span class="op">=</span> <span class="st">"B"</span>,
                              strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>
<span class="op">)</span></pre></div>
</div>
<div id="converting-to-a-stem-format" class="section level1">
<h1 class="hasAnchor">
<a href="#converting-to-a-stem-format" class="anchor"></a>Converting to a STEM format</h1>
<p>This is done using <tt>convSTEM</tt>. Depending on if a <tt>runPSM</tt> object or a <tt>bootPSM</tt> object or both are provided different quantities will be estimated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="co"># only supplying x</span>
<span class="va">PFS_conv_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convSTEM.html">convSTEM</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">psm_PFS_expweib</span><span class="op">)</span>

<span class="co"># only supplying samples</span>
<span class="va">PFS_conv_samples</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/convSTEM.html">convSTEM</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="va">psm_boot_PFS_expweib</span><span class="op">)</span>

<span class="co"># supplying both x and samples from the same set of models</span>
<span class="va">PFS_conv_both</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/convSTEM.html">convSTEM</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">psm_PFS_expweib</span>, samples <span class="op">=</span> <span class="va">psm_boot_PFS_expweib</span><span class="op">)</span></pre></div>
</div>
<div id="the-output-of-convstem" class="section level1">
<h1 class="hasAnchor">
<a href="#the-output-of-convstem" class="anchor"></a>The output of convSTEM</h1>
<p><tt>convSTEM</tt> returns a list of four data frames containing parameters converted to match those reported by an existing SAS macro.</p>
<ul>
<li>
<tt>stem_param</tt> The parameter estimates</li>
<li>
<tt>stem_cov</tt> Estimates for a covariance matrix for the parameters derived from the bootstrap samples.</li>
<li>
<tt>stem_modsum</tt> A summary of the model fit statistics.</li>
<li>
<tt>stem_boot</tt> A data frame of converted boot strap estimates.</li>
</ul>
<div id="stem_param" class="section level2">
<h2 class="hasAnchor">
<a href="#stem_param" class="anchor"></a>stem_param</h2>
<p><tt>stem_param</tt> contains the parameter estimates and is calculated if either x or samples is provided.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_param</span><span class="op">)</span>
<span class="co">#&gt; [1] "Model"    "ModelF"   "Dist"     "DistF"    "Param"    "ParamF"   "Estimate"</span>

<span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_param</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">Param</span>, <span class="va">Estimate</span><span class="op">)</span> 
<span class="co">#&gt;                      Model        Dist            Param   Estimate</span>
<span class="co">#&gt; 1             Common Shape Exponential        INTERCEPT  6.1145985</span>
<span class="co">#&gt; 2             Common Shape Exponential TX(Intervention) -0.7675910</span>
<span class="co">#&gt; 3             Common Shape     Weibull        INTERCEPT  6.0800704</span>
<span class="co">#&gt; 4             Common Shape     Weibull TX(Intervention) -0.6623183</span>
<span class="co">#&gt; 5             Common Shape     Weibull            SCALE  0.7204249</span>
<span class="co">#&gt; 6     Separate - Reference Exponential        INTERCEPT  6.1145985</span>
<span class="co">#&gt; 7     Separate - Reference     Weibull        INTERCEPT  6.0798340</span>
<span class="co">#&gt; 8     Separate - Reference     Weibull            SCALE  0.7171585</span>
<span class="co">#&gt; 9  Separate - Intervention Exponential        INTERCEPT  5.3470075</span>
<span class="co">#&gt; 10 Separate - Intervention     Weibull        INTERCEPT  5.4170457</span>
<span class="co">#&gt; 11 Separate - Intervention     Weibull            SCALE  0.7224962</span>

<span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_param</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">Param</span>, <span class="va">Estimate</span><span class="op">)</span> 
<span class="co">#&gt;                      Model        Dist            Param   Estimate</span>
<span class="co">#&gt; 1             Common Shape Exponential        INTERCEPT  6.1145985</span>
<span class="co">#&gt; 2             Common Shape Exponential TX(Intervention) -0.7675910</span>
<span class="co">#&gt; 3             Common Shape     Weibull        INTERCEPT  6.0800704</span>
<span class="co">#&gt; 4             Common Shape     Weibull TX(Intervention) -0.6623183</span>
<span class="co">#&gt; 5             Common Shape     Weibull            SCALE  0.7204249</span>
<span class="co">#&gt; 6     Separate - Reference Exponential        INTERCEPT  6.1145985</span>
<span class="co">#&gt; 7     Separate - Reference     Weibull        INTERCEPT  6.0798340</span>
<span class="co">#&gt; 8     Separate - Reference     Weibull            SCALE  0.7171585</span>
<span class="co">#&gt; 9  Separate - Intervention Exponential        INTERCEPT  5.3470075</span>
<span class="co">#&gt; 10 Separate - Intervention     Weibull        INTERCEPT  5.4170457</span>
<span class="co">#&gt; 11 Separate - Intervention     Weibull            SCALE  0.7224962</span></pre></div>
</div>
<div id="stem_cov" class="section level2">
<h2 class="hasAnchor">
<a href="#stem_cov" class="anchor"></a>stem_cov</h2>
<p><tt>stem_cov</tt> contains estimates for a covariance matrix for the parameters and is only derived if samples is provided.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_cov</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Model"     "ModelF"    "Dist"      "DistF"     "rowParam"  "colParam" </span>
<span class="co">#&gt;  [7] "rowParamF" "colParamF" "rowNum"    "colNum"    "CovEst"</span>

<span class="co"># note is empty here as samples were not provided</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_cov</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>

<span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_cov</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">rowParam</span>, <span class="va">colParam</span>, <span class="va">rowNum</span>, <span class="va">colNum</span>, <span class="va">CovEst</span><span class="op">)</span> 
<span class="co">#&gt; # A tibble: 23 × 7</span>
<span class="co">#&gt;    Model        Dist        rowParam         colParam     rowNum colNum   CovEst</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Common Shape Exponential INTERCEPT        INTERCEPT         1      1  4.54e-3</span>
<span class="co">#&gt;  2 Common Shape Exponential INTERCEPT        TX(Interven…      1      2 -4.86e-3</span>
<span class="co">#&gt;  3 Common Shape Exponential TX(Intervention) INTERCEPT         2      1 -4.86e-3</span>
<span class="co">#&gt;  4 Common Shape Exponential TX(Intervention) TX(Interven…      2      2  7.93e-3</span>
<span class="co">#&gt;  5 Common Shape Weibull     INTERCEPT        INTERCEPT         1      1  2.98e-3</span>
<span class="co">#&gt;  6 Common Shape Weibull     INTERCEPT        TX(Interven…      1      2 -3.18e-3</span>
<span class="co">#&gt;  7 Common Shape Weibull     INTERCEPT        SCALE             1      3  8.86e-5</span>
<span class="co">#&gt;  8 Common Shape Weibull     TX(Intervention) INTERCEPT         2      1 -3.18e-3</span>
<span class="co">#&gt;  9 Common Shape Weibull     TX(Intervention) TX(Interven…      2      2  5.80e-3</span>
<span class="co">#&gt; 10 Common Shape Weibull     TX(Intervention) SCALE             2      3 -7.51e-5</span>
<span class="co">#&gt; # … with 13 more rows</span></pre></div>
<p>The matrix is described by row and column numbers so can be back converted to a matrix if desired.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="co"># select a single model from the data frame</span>
<span class="va">weibull_common_data</span> <span class="op">&lt;-</span> <span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_cov</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"Common Shape"</span>, <span class="va">Dist</span> <span class="op">==</span> <span class="st">"Weibull"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">rowParam</span>, <span class="va">colParam</span>, <span class="va">rowNum</span>, <span class="va">colNum</span>, <span class="va">CovEst</span><span class="op">)</span>

<span class="va">weibull_common_data</span>
<span class="co">#&gt; # A tibble: 9 × 5</span>
<span class="co">#&gt;   rowParam         colParam         rowNum colNum     CovEst</span>
<span class="co">#&gt;   &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 INTERCEPT        INTERCEPT             1      1  0.00298  </span>
<span class="co">#&gt; 2 INTERCEPT        TX(Intervention)      1      2 -0.00318  </span>
<span class="co">#&gt; 3 INTERCEPT        SCALE                 1      3  0.0000886</span>
<span class="co">#&gt; 4 TX(Intervention) INTERCEPT             2      1 -0.00318  </span>
<span class="co">#&gt; 5 TX(Intervention) TX(Intervention)      2      2  0.00580  </span>
<span class="co">#&gt; 6 TX(Intervention) SCALE                 2      3 -0.0000751</span>
<span class="co">#&gt; 7 SCALE            INTERCEPT             3      1  0.0000886</span>
<span class="co">#&gt; 8 SCALE            TX(Intervention)      3      2 -0.0000751</span>
<span class="co">#&gt; 9 SCALE            SCALE                 3      3  0.000750</span>

<span class="co"># can see is ordered by row so can convert to a matrix</span>

<span class="va">weibull_common_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">weibull_common_data</span><span class="op">$</span><span class="va">CovEst</span>,
                                nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># applying names</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">weibull_common_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">weibull_common_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">weibull_common_data</span><span class="op">$</span><span class="va">colParam</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>

<span class="va">weibull_common_matrix</span>
<span class="co">#&gt;                      INTERCEPT TX(Intervention)         SCALE</span>
<span class="co">#&gt; INTERCEPT         2.976351e-03    -3.184138e-03  8.859245e-05</span>
<span class="co">#&gt; TX(Intervention) -3.184138e-03     5.803708e-03 -7.510364e-05</span>
<span class="co">#&gt; SCALE             8.859245e-05    -7.510364e-05  7.501754e-04</span></pre></div>
</div>
<div id="stem_modsum" class="section level2">
<h2 class="hasAnchor">
<a href="#stem_modsum" class="anchor"></a>stem_modsum</h2>
<p><tt>stem_modsum</tt> contains a summary of the model fit statistics and is only produced if x is provided.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_modsum</span><span class="op">)</span>
<span class="co">#&gt; [1] "Model"   "ModelF"  "Dist"    "DistF"   "Status"  "AIC"     "AIC_SAS"</span>
<span class="co">#&gt; [8] "BIC"     "BIC_SAS"</span>

<span class="co"># note is empty here as x was not provided</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_modsum</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>

<span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_modsum</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">Status</span>, <span class="va">AIC</span>, <span class="va">AIC_SAS</span>, <span class="va">BIC</span>, <span class="va">BIC_SAS</span><span class="op">)</span> 
<span class="co">#&gt;                     Model        Dist    Status      AIC   AIC_SAS      BIC</span>
<span class="co">#&gt; 1            Common Shape Exponential Converged 5600.660 1326.3479 5609.089</span>
<span class="co">#&gt; 2            Common Shape     Weibull Converged 5545.222 1270.9094 5557.866</span>
<span class="co">#&gt; 3 Separate - Intervention Exponential Converged 3023.176  671.5601 3026.697</span>
<span class="co">#&gt; 4 Separate - Intervention     Weibull Converged 2990.943  639.3272 2997.986</span>
<span class="co">#&gt; 5    Separate - Reference Exponential Converged 2577.485  654.7878 2581.006</span>
<span class="co">#&gt; 6    Separate - Reference     Weibull Converged 2556.271  633.5741 2563.314</span>
<span class="co">#&gt;     BIC_SAS</span>
<span class="co">#&gt; 1 1334.7771</span>
<span class="co">#&gt; 2 1283.5533</span>
<span class="co">#&gt; 3  675.0816</span>
<span class="co">#&gt; 4  646.3702</span>
<span class="co">#&gt; 5  658.3092</span>
<span class="co">#&gt; 6  640.6170</span></pre></div>
</div>
<div id="stem_boot" class="section level2">
<h2 class="hasAnchor">
<a href="#stem_boot" class="anchor"></a>stem_boot</h2>
<p><tt>stem_boot</tt> contains a data frame of converted boot strap estimates and is only derived if samples is provided.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_boot</span><span class="op">)</span>
<span class="co">#&gt; [1] "Model"      "ModelF"     "Dist"       "DistF"      "BootSample"</span>
<span class="co">#&gt; [6] "Param"      "ParamF"     "Estimate"</span>

<span class="co"># note is empty here as samples were not provided</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">PFS_conv_x</span><span class="op">$</span><span class="va">stem_boot</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>

<span class="va">PFS_conv_samples</span><span class="op">$</span><span class="va">stem_boot</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">BootSample</span>, <span class="va">Param</span>, <span class="va">Estimate</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;          Model        Dist BootSample            Param   Estimate</span>
<span class="co">#&gt; 1 Common Shape Exponential          1        INTERCEPT  6.1289156</span>
<span class="co">#&gt; 2 Common Shape Exponential          1 TX(Intervention) -0.7908096</span>
<span class="co">#&gt; 3 Common Shape Exponential          2        INTERCEPT  6.0663108</span>
<span class="co">#&gt; 4 Common Shape Exponential          2 TX(Intervention) -0.6928566</span>
<span class="co">#&gt; 5 Common Shape Exponential          3        INTERCEPT  6.0120960</span>
<span class="co">#&gt; 6 Common Shape Exponential          3 TX(Intervention) -0.6119670</span></pre></div>
</div>
</div>
<div id="details-on-conversions" class="section level1">
<h1 class="hasAnchor">
<a href="#details-on-conversions" class="anchor"></a>Details on conversions</h1>
<p>To illustrate the conversions will fit a full set of models to the data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">psm_PFS_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">PFS_data</span>,
                     time_var<span class="op">=</span><span class="st">"AVAL"</span>,
                     event_var<span class="op">=</span><span class="st">"event"</span>,
                     model.type<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Common shape"</span>, 
                                   <span class="st">"Independent shape"</span>, 
                                   <span class="st">"Separate"</span><span class="op">)</span>,
                     distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exp'</span>,
                               <span class="st">'weibull'</span>,
                               <span class="st">'gompertz'</span>,
                               <span class="st">'lnorm'</span>,
                               <span class="st">'llogis'</span>,
                               <span class="st">'gengamma'</span>,
                               <span class="st">'gamma'</span>,
                               <span class="st">'genf'</span><span class="op">)</span>,
                     strata_var <span class="op">=</span> <span class="st">"ARMCD"</span>,
                     int_name<span class="op">=</span><span class="st">"A"</span>,
                     ref_name <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span>

<span class="co"># only supplying x</span>
<span class="va">PFS_conv_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convSTEM.html">convSTEM</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">psm_PFS_all</span><span class="op">)</span></pre></div>
<div id="conversion-of-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-of-parameters" class="anchor"></a>Conversion of parameters</h2>
<p>Note in general independent shape models were not estimated by STEM macro so are converted for backwards compatability as if if they were estimated by separate models. This has implications for how AIC and BIC should be interpreted in these cases.</p>
<div id="conversion-of-exponential-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-exponential-models" class="anchor"></a>Conversion of Exponential models</h3>
<p><tt>flexsurvPlus</tt> uses the parameter rate (<span class="math inline">\(b\)</span>). For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(b_R\)</span> for reference and <span class="math inline">\(b_I\)</span> for intervention.</p>
<p>The SAS STEM macro reports INTERCEPT and TX(INTERVENTION) which are converted as shown below.</p>
<div id="seperate-models" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_R)\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_I)\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_R)\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(-(log(b_I) - log(b_R))\)</span>
</li>
</ul>
</div>
</div>
<div id="conversion-of-weibull-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-weibull-models" class="anchor"></a>Conversion of Weibull models</h3>
<p><tt>flexsurvPlus</tt> uses the parameters scale (<span class="math inline">\(b\)</span>) and shape (<span class="math inline">\(a\)</span>). For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(b_R, a_R\)</span> for reference and <span class="math inline">\(b_I, a_I\)</span> for intervention. For common shape models <span class="math inline">\(a_R=a_I\)</span>.</p>
<p>The SAS STEM macro reports INTERCEPT, TX(INTERVENTION) and SCALE which are converted as shown below.</p>
<div id="seperate-models-1" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models-1" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(log(b_R)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_R}\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(log(b_I)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_I}\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models-1" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models-1" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(log(b_R)\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(log(b_I) - log(b_R)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_R}\)</span>
</li>
</ul>
</div>
</div>
<div id="conversion-of-gompertz-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-gompertz-models" class="anchor"></a>Conversion of Gompertz models</h3>
<p><tt>flexsurvPlus</tt> uses the parameters rate (<span class="math inline">\(b\)</span>) and shape (<span class="math inline">\(a\)</span>). For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(b_R, a_R\)</span> for reference and <span class="math inline">\(b_I, a_I\)</span> for intervention. For common shape models <span class="math inline">\(a_R=a_I\)</span>.</p>
<p>The SAS STEM macro reports INTERCEPT, TX(INTERVENTION) and SCALE which are converted as shown below.</p>
<div id="seperate-models-2" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models-2" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_R)\)</span>
</li>
<li>SCALE = <span class="math inline">\(a_R\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_I)\)</span>
</li>
<li>SCALE = <span class="math inline">\(a_I\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models-2" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models-2" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_R)\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(-(log(b_I) - log(b_R))\)</span>
</li>
<li>SCALE = <span class="math inline">\(a_R\)</span>
</li>
</ul>
</div>
</div>
<div id="conversion-of-log-logistic-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-log-logistic-models" class="anchor"></a>Conversion of Log-logistic models</h3>
<p><tt>flexsurvPlus</tt> uses the parameters scale (<span class="math inline">\(b\)</span>) and shape (<span class="math inline">\(a\)</span>). For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(b_R, a_R\)</span> for reference and <span class="math inline">\(b_I, a_I\)</span> for intervention. For common shape models <span class="math inline">\(a_R=a_I\)</span>.</p>
<p>The SAS STEM macro reports INTERCEPT, TX(INTERVENTION) and SCALE which are converted as shown below.</p>
<div id="seperate-models-3" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models-3" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(log(b_R)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_R}\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(log(b_I)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_I}\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models-3" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models-3" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(-log(b_R)\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(log(b_I) - log(B_R)\)</span>
</li>
<li>SCALE = <span class="math inline">\(\frac{1}{a_R}\)</span>
</li>
</ul>
</div>
</div>
<div id="conversion-of-log-normal-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-log-normal-models" class="anchor"></a>Conversion of Log-normal models</h3>
<p><tt>flexsurvPlus</tt> uses the parameters meanlog (<span class="math inline">\(\mu\)</span>) and sdlog (<span class="math inline">\(\sigma\)</span>). For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(\mu_R, \sigma_R\)</span> for reference and <span class="math inline">\(\mu_I, \sigma_I\)</span> for intervention. For common shape models <span class="math inline">\(\sigma_R=\sigma_I\)</span>.</p>
<p>The SAS STEM macro reports INTERCEPT, TX(INTERVENTION) and SCALE which are converted as shown below.</p>
<div id="seperate-models-4" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models-4" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_R\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_R\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_I\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_I\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models-4" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models-4" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_R\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(\mu_I - \mu_R\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_R\)</span>
</li>
</ul>
</div>
</div>
<div id="conversion-of-generalized-gamma-models" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-of-generalized-gamma-models" class="anchor"></a>Conversion of Generalized Gamma models</h3>
<p><tt>flexsurvPlus</tt> uses the parameters mu (<span class="math inline">\(\mu\)</span>), sigma (<span class="math inline">\(\sigma\)</span>) and <span class="math inline">\(Q\)</span>. For common shape, independent shape and separate models these can be denoted as <span class="math inline">\(\mu_R, \sigma_R, Q_R\)</span> for reference and <span class="math inline">\(\mu_I, \sigma_I, Q_I\)</span> for intervention. For common shape models <span class="math inline">\(\sigma_R=\sigma_I\)</span> and <span class="math inline">\(Q_R=\)</span>Q_I$.</p>
<p>The SAS STEM macro reports INTERCEPT, TX(INTERVENTION), SCALE and SHAPE which are converted as shown below.</p>
<div id="seperate-models-5" class="section level4">
<h4 class="hasAnchor">
<a href="#seperate-models-5" class="anchor"></a>Seperate models</h4>
<ul>
<li>Reference arm
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_R\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_R\)</span>
</li>
<li>SHAPE = <span class="math inline">\(Q_R\)</span>
</li>
</ul>
</li>
<li>Intervention arm
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_I\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_I\)</span>
</li>
<li>SHAPE = <span class="math inline">\(Q_I\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="common-shape-models-5" class="section level4">
<h4 class="hasAnchor">
<a href="#common-shape-models-5" class="anchor"></a>Common shape models</h4>
<ul>
<li>INTERCEPT = <span class="math inline">\(\mu_R\)</span>
</li>
<li>TX(INTERVENTION) = <span class="math inline">\(\mu_I - \mu_R\)</span>
</li>
<li>SCALE = <span class="math inline">\(\sigma_R\)</span>
</li>
<li>SHAPE = <span class="math inline">\(Q_R\)</span>
</li>
</ul>
</div>
</div>
</div>
<div id="conversion-of-aic-and-bic" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-of-aic-and-bic" class="anchor"></a>Conversion of AIC and BIC</h2>
<p>As the existing SAS STEM macro estimated models with log(time) as a response variable while <tt>flexsurv</tt> and <tt>flexsurvPlus</tt> estimate models with time as the response variable there are differences in the log-likelihood between the two software packages. These differences do not affect the parameter estimates or ranking of fit but do affect the AIC and BIC reported by a constant.</p>
<p>This constant is the sum of the events log(time). As such can convert by adding this constant to the maximum log-likelihood and by extension double the sum of the events log(time) to AIC or BIC.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">

<span class="co"># This constant is estimated from the sum of the log of times for patients who have an event</span>

<span class="va">PFS_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">event</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># select events only</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>log_event_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># difference in log time</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">log_event_time</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt;   2 * sum(log_event_time)</span>
<span class="co">#&gt; 1                4274.312</span>

<span class="co"># So for common shape models (using all data) the difference is 4274.312</span>

<span class="co"># Can be seen in results from convSTEM here</span>
<span class="va">modsum</span> <span class="op">&lt;-</span> <span class="va">PFS_conv_all</span><span class="op">$</span><span class="va">stem_modsum</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">Dist</span>, <span class="va">AIC</span>, <span class="va">AIC_SAS</span>, <span class="va">BIC</span>, <span class="va">BIC_SAS</span><span class="op">)</span> 

<span class="co"># note as the separate and common shape models use different data these are not comparable</span>
<span class="va">modsum</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>delta_AIC <span class="op">=</span> <span class="va">AIC</span> <span class="op">-</span> <span class="va">AIC_SAS</span>,
         delta_BIC <span class="op">=</span> <span class="va">AIC</span> <span class="op">-</span> <span class="va">AIC_SAS</span><span class="op">)</span>
<span class="co">#&gt;                      Model              Dist      AIC   AIC_SAS      BIC</span>
<span class="co">#&gt; 1             Common Shape       Exponential 5600.660 1326.3479 5609.089</span>
<span class="co">#&gt; 2             Common Shape           Weibull 5545.222 1270.9094 5557.866</span>
<span class="co">#&gt; 3             Common Shape          Gompertz 5564.003 1289.6905 5576.647</span>
<span class="co">#&gt; 4             Common Shape        Log Normal 5606.451 1332.1382 5619.094</span>
<span class="co">#&gt; 5             Common Shape      Log Logistic 5566.512 1292.1995 5579.156</span>
<span class="co">#&gt; 6             Common Shape Generalized Gamma 5546.841 1272.5287 5563.699</span>
<span class="co">#&gt; 7  Separate - Intervention       Exponential 3023.176  671.5601 3026.697</span>
<span class="co">#&gt; 8  Separate - Intervention           Weibull 2990.943  639.3272 2997.986</span>
<span class="co">#&gt; 9  Separate - Intervention          Gompertz 3005.220  653.6042 3012.263</span>
<span class="co">#&gt; 10 Separate - Intervention        Log Normal 3021.443  669.8278 3028.486</span>
<span class="co">#&gt; 11 Separate - Intervention      Log Logistic 3002.733  651.1172 3009.776</span>
<span class="co">#&gt; 12 Separate - Intervention Generalized Gamma 2991.950  640.3347 3002.514</span>
<span class="co">#&gt; 13    Separate - Reference       Exponential 2577.485  654.7878 2581.006</span>
<span class="co">#&gt; 14    Separate - Reference           Weibull 2556.271  633.5741 2563.314</span>
<span class="co">#&gt; 15    Separate - Reference          Gompertz 2560.755  638.0579 2567.798</span>
<span class="co">#&gt; 16    Separate - Reference        Log Normal 2582.939  660.2420 2589.982</span>
<span class="co">#&gt; 17    Separate - Reference      Log Logistic 2563.469  640.7722 2570.512</span>
<span class="co">#&gt; 18    Separate - Reference Generalized Gamma 2558.162  635.4655 2568.727</span>
<span class="co">#&gt; 19       Independent Shape       Exponential 5600.660 1326.3479 5609.089</span>
<span class="co">#&gt; 20       Independent Shape           Weibull 5547.214 1272.9013 5564.072</span>
<span class="co">#&gt; 21       Independent Shape          Gompertz 5565.974 1291.6621 5582.833</span>
<span class="co">#&gt; 22       Independent Shape      Log Logistic 5566.202 1291.8894 5583.060</span>
<span class="co">#&gt; 23       Independent Shape        Log Normal 5604.382 1330.0698 5621.241</span>
<span class="co">#&gt; 24       Independent Shape Generalized Gamma 5550.112 1275.8001 5575.400</span>
<span class="co">#&gt;      BIC_SAS delta_AIC delta_BIC</span>
<span class="co">#&gt; 1  1334.7771  4274.312  4274.312</span>
<span class="co">#&gt; 2  1283.5533  4274.312  4274.312</span>
<span class="co">#&gt; 3  1302.3343  4274.312  4274.312</span>
<span class="co">#&gt; 4  1344.7821  4274.312  4274.312</span>
<span class="co">#&gt; 5  1304.8433  4274.312  4274.312</span>
<span class="co">#&gt; 6  1289.3872  4274.312  4274.312</span>
<span class="co">#&gt; 7   675.0816  2351.615  2351.615</span>
<span class="co">#&gt; 8   646.3702  2351.615  2351.615</span>
<span class="co">#&gt; 9   660.6471  2351.615  2351.615</span>
<span class="co">#&gt; 10  676.8707  2351.615  2351.615</span>
<span class="co">#&gt; 11  658.1602  2351.615  2351.615</span>
<span class="co">#&gt; 12  650.8991  2351.615  2351.615</span>
<span class="co">#&gt; 13  658.3092  1922.697  1922.697</span>
<span class="co">#&gt; 14  640.6170  1922.697  1922.697</span>
<span class="co">#&gt; 15  645.1009  1922.697  1922.697</span>
<span class="co">#&gt; 16  667.2849  1922.697  1922.697</span>
<span class="co">#&gt; 17  647.8151  1922.697  1922.697</span>
<span class="co">#&gt; 18  646.0299  1922.697  1922.697</span>
<span class="co">#&gt; 19 1334.7771  4274.312  4274.312</span>
<span class="co">#&gt; 20 1289.7598  4274.312  4274.312</span>
<span class="co">#&gt; 21 1308.5206  4274.312  4274.312</span>
<span class="co">#&gt; 22 1308.7478  4274.312  4274.312</span>
<span class="co">#&gt; 23 1346.9282  4274.312  4274.312</span>
<span class="co">#&gt; 24 1301.0878  4274.312  4274.312</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
