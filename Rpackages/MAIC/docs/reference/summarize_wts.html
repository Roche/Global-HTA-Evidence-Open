<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summarize the weight values — summarize_wts • MAIC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Summarize the weight values — summarize_wts" />
<meta property="og:description" content="Produce a summary of the weights (minimum, maximum, median, mean, standard
deviation). Mean and standard deviation are provided for completeness.
In practice the distribution of weights may be skewed in which case mean and
SD should be interpreted with caution." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-181075487-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-181075487-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MAIC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MAIC.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/MAIC/docs/index.html">MAIC</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/gemtcPlus/docs/index.html">gemtcPlus</a>
    </li>
    <li>
      <a href="https://roche.github.io/Global-HTA-Evidence-Open/Rpackages/rpsftmPlus/docs/index.html">rpsftmPlus</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Roche/Global-HTA-Evidence-Open/tree/master/Rpackages/MAIC">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarize the weight values</h1>
    
    <div class="hidden name"><code>summarize_wts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produce a summary of the weights (minimum, maximum, median, mean, standard
deviation). Mean and standard deviation are provided for completeness.
In practice the distribution of weights may be skewed in which case mean and
SD should be interpreted with caution.</p>
    </div>

    <pre class="usage"><span class='fu'>summarize_wts</span>(<span class='no'>data</span>, <span class='kw'>wt_col</span> <span class='kw'>=</span> <span class='st'>"wt"</span>, <span class='kw'>rs_wt_col</span> <span class='kw'>=</span> <span class='st'>"wt_rs"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame containing individual patient data from
the intervention study, including a column containing the weights (derived
using <code><a href='estimate_weights.html'>estimate_weights</a></code>).</p></td>
    </tr>
    <tr>
      <th>wt_col</th>
      <td><p>The name of the weights column in the data frame containing the
intervention individual patient data and the MAIC propensity weights. The
default is wt.</p></td>
    </tr>
    <tr>
      <th>rs_wt_col</th>
      <td><p>The name of the rescaled weights column in the data frame
containing the intervention individual patient data and the MAIC propensity
weights. The default is wt_rs.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame that includes a summary (minimum, maximum, median, mean,
  standard deviation) of the weights and rescaled weights.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='estimate_weights.html'>estimate_weights</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># This example code uses the weighted individual patient data, outputted from</span>
<span class='co'># the estimate_weights function to perform weight diagnostics. The weighted data</span>
<span class='co'># is saved within est_weights. To check the weighted aggregate baseline</span>
<span class='co'># characteristics for 'intervention' match those in the comparator data,</span>
<span class='co'># standardized data "target_pop_standard" is used. Please see the package</span>
<span class='co'># vignette for more information on how to use the estimate_weights function and</span>
<span class='co'># derive the "target_pop_standard" data.</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>MAIC</span>)

<span class='co'># load est_weights</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>est_weights</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MAIC"</span>)

<span class='co'># load target_pop_standard</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>target_pop_standard</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"MAIC"</span>)

<span class='co'># List out the uncentered variables used in the matching</span>
<span class='no'>match_cov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"AGE"</span>,
               <span class='st'>"SEX"</span>,
               <span class='st'>"SMOKE"</span>,
               <span class='st'>"ECOG0"</span>)

<span class='co'># Are the weights sensible? ----------------------------------------------------</span>

<span class='co'># The wt_diagnostics function requires the output from the estimate_weights</span>
<span class='co'># function and will output:</span>
<span class='co'># - the effective sample size (ESS)</span>
<span class='co'># - a summary of the weights and rescaled weights (mean, standard deviation,</span>
<span class='co'>#   median, minimum and maximum)</span>
<span class='co'># - a unique set of weights with the corresponding patient profile based on the</span>
<span class='co'>#   matching variables</span>

<span class='no'>diagnostics</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='wt_diagnostics.html'>wt_diagnostics</a></span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>,
                              <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>match_cov</span>)

<span class='no'>diagnostics</span>$<span class='no'>ESS</span></div><div class='output co'>#&gt; [1] 157.0715</div><div class='input'><span class='no'>diagnostics</span>$<span class='no'>Summary_of_weights</span></div><div class='output co'>#&gt;               type      mean       sd     median          min      max
#&gt; 1          Weights 0.3763805 0.556692 0.03467630 1.855194e-11 2.373310
#&gt; 2 Rescaled weights 1.0000000 1.479067 0.09213098 4.929037e-11 6.305614</div><div class='input'><span class='no'>diagnostics</span>$<span class='no'>Weight_profiles</span></div><div class='output co'>#&gt;     AGE SEX SMOKE ECOG0           wt        wt_rs
#&gt; 1    45   1     0     0 1.301506e+00 3.457953e+00
#&gt; 2    71   1     0     0 7.024764e-08 1.866400e-07
#&gt; 3    58   1     1     1 6.384284e-02 1.696231e-01
#&gt; 4    48   0     0     1 1.204094e+00 3.199141e+00
#&gt; 5    69   1     0     1 1.371621e-06 3.644239e-06
#&gt; 6    47   1     1     0 1.010290e+00 2.684226e+00
#&gt; 7    61   1     1     0 7.016834e-03 1.864293e-02
#&gt; 8    54   0     1     1 2.610269e-01 6.935186e-01
#&gt; 9    56   0     1     0 1.165019e-01 3.095323e-01
#&gt; 10   63   0     0     0 1.212450e-03 3.221341e-03
#&gt; 11   50   0     0     0 1.277640e+00 3.394543e+00
#&gt; 12   57   1     0     1 2.355647e-01 6.258685e-01
#&gt; 13   62   0     1     1 1.515077e-03 4.025386e-03
#&gt; 14   57   0     0     1 1.307047e-01 3.472675e-01
#&gt; 15   66   1     0     0 7.757577e-05 2.061100e-04
#&gt; 16   75   1     1     1 3.343552e-11 8.883437e-11
#&gt; 17   47   0     0     0 1.126587e+00 2.993213e+00
#&gt; 18   57   1     0     0 2.470419e-01 6.563622e-01
#&gt; 19   54   1     0     0 9.915215e-01 2.634359e+00
#&gt; 20   55   1     1     0 3.336792e-01 8.865476e-01
#&gt; 21   64   1     0     1 7.360573e-04 1.955620e-03
#&gt; 22   53   0     1     0 3.765647e-01 1.000489e+00
#&gt; 23   47   1     0     0 2.030410e+00 5.394567e+00
#&gt; 24   60   0     1     0 8.875806e-03 2.358200e-02
#&gt; 25   49   0     0     1 1.255669e+00 3.336168e+00
#&gt; 26   55   0     0     0 3.720898e-01 9.886001e-01
#&gt; 27   66   0     0     1 4.104372e-05 1.090485e-04
#&gt; 28   58   1     0     1 1.283068e-01 3.408965e-01
#&gt; 29   49   1     0     1 2.263049e+00 6.012663e+00
#&gt; 30   61   1     0     0 1.410194e-02 3.746723e-02
#&gt; 31   66   1     1     0 3.860012e-05 1.025561e-04
#&gt; 32   59   0     1     1 1.795110e-02 4.769403e-02
#&gt; 33   74   0     1     0 1.218200e-10 3.236619e-10
#&gt; 34   73   0     0     0 1.426210e-09 3.789276e-09
#&gt; 35   74   1     0     1 4.207407e-10 1.117860e-09
#&gt; 36   58   0     1     1 3.542365e-02 9.411659e-02
#&gt; 37   61   0     0     1 7.461039e-03 1.982313e-02
#&gt; 38   47   0     1     1 5.345235e-01 1.420168e+00
#&gt; 39   73   0     1     1 6.766831e-10 1.797870e-09
#&gt; 40   68   1     0     0 5.841352e-06 1.551981e-05
#&gt; 41   49   0     0     0 1.316848e+00 3.498714e+00
#&gt; 42   71   0     0     0 3.897740e-08 1.035585e-07
#&gt; 43   70   1     0     1 3.142487e-07 8.349228e-07
#&gt; 44   62   0     1     0 1.588895e-03 4.221512e-03
#&gt; 45   49   1     0     0 2.373310e+00 6.305614e+00
#&gt; 46   74   0     0     0 2.448252e-10 6.504727e-10
#&gt; 47   46   0     0     1 8.916746e-01 2.369078e+00
#&gt; 48   68   0     1     0 1.612713e-06 4.284793e-06
#&gt; 49   46   1     1     0 8.385873e-01 2.228031e+00
#&gt; 50   75   0     1     1 1.855194e-11 4.929037e-11
#&gt; 51   56   1     0     1 4.023732e-01 1.069060e+00
#&gt; 52   72   0     0     0 7.729812e-09 2.053723e-08
#&gt; 53   57   1     1     1 1.172122e-01 3.114193e-01
#&gt; 54   46   1     0     0 1.685333e+00 4.477738e+00
#&gt; 55   56   0     1     1 1.110894e-01 2.951518e-01
#&gt; 56   73   1     0     1 2.450991e-09 6.512004e-09
#&gt; 57   60   0     1     1 8.463447e-03 2.248641e-02
#&gt; 58   75   1     0     0 7.047030e-11 1.872316e-10
#&gt; 59   69   0     1     1 3.786845e-07 1.006122e-06
#&gt; 60   47   0     0     1 1.074247e+00 2.854152e+00
#&gt; 61   74   1     0     0 4.412402e-10 1.172325e-09
#&gt; 62   71   0     0     1 3.716656e-08 9.874729e-08
#&gt; 63   49   0     1     1 6.247950e-01 1.660009e+00
#&gt; 64   45   0     0     0 7.221499e-01 1.918670e+00
#&gt; 65   68   0     0     0 3.241115e-06 8.611273e-06
#&gt; 66   60   1     0     0 3.214876e-02 8.541558e-02
#&gt; 67   45   0     1     0 3.593270e-01 9.546908e-01
#&gt; 68   57   0     0     0 1.370730e-01 3.641872e-01
#&gt; 69   50   0     0     1 1.218282e+00 3.236837e+00
#&gt; 70   63   1     0     1 2.083637e-03 5.535987e-03
#&gt; 71   68   0     0     1 3.090537e-06 8.211204e-06
#&gt; 72   51   1     0     0 2.078541e+00 5.522446e+00
#&gt; 73   52   0     1     0 4.819386e-01 1.280456e+00
#&gt; 74   69   1     1     1 6.824903e-07 1.813299e-06
#&gt; 75   70   0     0     1 1.743631e-07 4.632628e-07
#&gt; 76   72   1     0     0 1.393118e-08 3.701355e-08
#&gt; 77   51   1     1     0 1.034239e+00 2.747856e+00
#&gt; 78   69   0     0     1 7.610533e-07 2.022032e-06
#&gt; 79   73   0     1     0 7.096527e-10 1.885466e-09
#&gt; 80   62   0     0     1 3.044894e-03 8.089934e-03
#&gt; 81   67   1     1     0 1.098128e-05 2.917601e-05
#&gt; 82   54   0     1     0 2.737447e-01 7.273085e-01
#&gt; 83   52   0     1     1 4.595483e-01 1.220967e+00
#&gt; 84   57   0     1     1 6.503599e-02 1.727932e-01
#&gt; 85   67   0     1     1 5.809967e-06 1.543642e-05
#&gt; 86   74   0     1     1 1.161604e-10 3.086249e-10
#&gt; 87   72   0     1     0 3.846196e-09 1.021890e-08
#&gt; 88   69   0     1     0 3.971349e-07 1.055142e-06
#&gt; 89   55   1     0     0 6.706048e-01 1.781720e+00
#&gt; 90   53   1     0     0 1.363942e+00 3.623839e+00
#&gt; 91   69   1     0     0 1.438449e-06 3.821795e-06
#&gt; 92   68   1     0     1 5.569970e-06 1.479877e-05
#&gt; 93   58   1     0     0 1.345582e-01 3.575058e-01
#&gt; 94   64   0     0     0 4.283051e-04 1.137958e-03
#&gt; 95   64   0     1     0 2.131159e-04 5.662245e-04
#&gt; 96   64   1     1     0 3.840915e-04 1.020487e-03
#&gt; 97   55   1     0     1 6.394493e-01 1.698944e+00
#&gt; 98   50   1     0     1 2.195669e+00 5.833641e+00
#&gt; 99   59   0     0     0 3.783460e-02 1.005222e-01
#&gt; 100  71   0     1     0 1.939435e-08 5.152859e-08
#&gt; 101  56   0     0     1 2.232596e-01 5.931752e-01
#&gt; 102  51   1     0     1 1.981974e+00 5.265879e+00
#&gt; 103  65   1     0     1 2.419131e-04 6.427356e-04
#&gt; 104  45   1     1     1 6.175160e-01 1.640669e+00
#&gt; 105  71   0     1     1 1.849332e-08 4.913463e-08
#&gt; 106  65   1     0     0 2.536997e-04 6.740512e-04
#&gt; 107  67   0     0     0 1.224536e-05 3.253453e-05
#&gt; 108  48   0     0     0 1.262761e+00 3.355011e+00
#&gt; 109  53   1     1     1 6.471395e-01 1.719376e+00
#&gt; 110  70   0     1     1 8.675950e-08 2.305101e-07
#&gt; 111  54   0     0     0 5.501527e-01 1.461693e+00
#&gt; 112  58   0     0     0 7.466057e-02 1.983646e-01
#&gt; 113  59   0     0     1 3.607685e-02 9.585207e-02
#&gt; 114  75   0     0     1 3.728436e-11 9.906029e-11
#&gt; 115  48   1     1     0 1.132407e+00 3.008675e+00
#&gt; 116  63   0     0     1 1.156121e-03 3.071681e-03
#&gt; 117  53   0     0     0 7.567929e-01 2.010712e+00
#&gt; 118  75   0     1     0 1.945583e-11 5.169192e-11
#&gt; 119  45   0     1     1 3.426331e-01 9.103370e-01
#&gt; 120  53   0     1     1 3.590699e-01 9.540078e-01
#&gt; 121  52   0     0     1 9.235676e-01 2.453814e+00
#&gt; 122  61   0     1     0 3.893340e-03 1.034416e-02
#&gt; 123  70   1     0     0 3.295596e-07 8.756022e-07
#&gt; 124  52   1     0     0 1.745614e+00 4.637896e+00
#&gt; 125  55   0     1     0 1.851443e-01 4.919072e-01
#&gt; 126  57   0     1     0 6.820470e-02 1.812121e-01
#&gt; 127  49   0     1     0 6.552365e-01 1.740889e+00
#&gt; 128  61   0     0     0 7.824558e-03 2.078896e-02
#&gt; 129  51   0     0     0 1.153293e+00 3.064168e+00
#&gt; 130  59   0     1     0 1.882572e-02 5.001779e-02
#&gt; 131  59   1     1     1 3.235266e-02 8.595733e-02
#&gt; 132  58   0     1     0 3.714957e-02 9.870217e-02
#&gt; 133  67   1     0     0 2.206940e-05 5.863588e-05
#&gt; 134  51   0     1     0 5.738550e-01 1.524667e+00
#&gt; 135  68   1     1     1 2.771503e-06 7.363567e-06
#&gt; 136  61   1     0     1 1.344678e-02 3.572655e-02
#&gt; 137  52   1     1     0 8.685815e-01 2.307722e+00
#&gt; 138  51   1     1     1 9.861898e-01 2.620194e+00
#&gt; 139  60   0     0     0 1.783797e-02 4.739344e-02
#&gt; 140  71   1     0     1 6.698402e-08 1.779689e-07
#&gt; 141  56   0     0     0 2.341373e-01 6.220761e-01
#&gt; 142  74   1     1     0 2.195521e-10 5.833248e-10
#&gt; 143  66   0     0     0 4.304346e-05 1.143616e-04
#&gt; 144  70   0     1     0 9.098662e-08 2.417411e-07
#&gt; 145  47   0     1     0 5.605667e-01 1.489362e+00
#&gt; 146  54   0     0     1 5.245933e-01 1.393784e+00
#&gt; 147  65   0     0     1 1.342272e-04 3.566264e-04
#&gt; 148  47   1     0     1 1.936079e+00 5.143942e+00
#&gt; 149  50   1     0     0 2.302647e+00 6.117870e+00
#&gt; 150  67   0     1     0 6.093042e-06 1.618852e-05
#&gt; 151  72   1     1     0 6.931869e-09 1.841718e-08
#&gt; 152  45   0     0     1 6.885997e-01 1.829531e+00
#&gt; 153  60   0     0     1 1.700924e-02 4.519160e-02
#&gt; 154  58   0     0     1 7.119193e-02 1.891488e-01
#&gt; 155  69   1     1     0 7.157428e-07 1.901647e-06
#&gt; 156  66   0     1     1 2.042251e-05 5.426029e-05
#&gt; 157  73   1     0     0 2.570409e-09 6.829284e-09
#&gt; 158  55   0     1     1 1.765427e-01 4.690538e-01
#&gt; 159  66   1     0     1 7.397170e-05 1.965344e-04
#&gt; 160  63   1     0     0 2.185157e-03 5.805713e-03
#&gt; 161  53   1     0     1 1.300575e+00 3.455479e+00
#&gt; 162  59   1     0     0 6.818802e-02 1.811678e-01
#&gt; 163  75   0     0     0 3.910094e-11 1.038867e-10
#&gt; 164  54   1     0     1 9.454567e-01 2.511970e+00
#&gt; 165  62   0     0     0 3.193248e-03 8.484095e-03
#&gt; 166  54   1     1     0 4.933608e-01 1.310803e+00
#&gt; 167  55   0     0     1 3.548030e-01 9.426710e-01
#&gt; 168  69   0     0     0 7.981336e-07 2.120550e-06
#&gt; 169  48   0     1     1 5.991327e-01 1.591827e+00
#&gt; 170  74   0     0     1 2.334509e-10 6.202525e-10
#&gt; 171  62   1     0     0 5.755082e-03 1.529060e-02
#&gt; 172  52   0     0     0 9.685659e-01 2.573369e+00
#&gt; 173  51   0     1     1 5.471944e-01 1.453833e+00
#&gt; 174  56   1     0     0 4.219777e-01 1.121147e+00
#&gt; 175  57   1     1     0 1.229230e-01 3.265924e-01
#&gt; 176  65   0     0     0 1.407671e-04 3.740020e-04
#&gt; 177  67   0     0     1 1.167646e-05 3.102302e-05
#&gt; 178  53   0     0     1 7.216332e-01 1.917297e+00
#&gt; 179  46   0     0     0 9.351191e-01 2.484505e+00
#&gt; 180  65   0     1     1 6.678871e-05 1.774500e-04
#&gt; 181  72   0     1     1 3.667507e-09 9.744146e-09
#&gt; 182  60   1     1     1 1.525338e-02 4.052650e-02
#&gt; 183  59   1     0     1 6.502008e-02 1.727509e-01
#&gt; 184  46   0     1     0 4.652961e-01 1.236239e+00
#&gt; 185  70   1     1     1 1.563637e-07 4.154405e-07
#&gt; 186  50   0     1     1 6.061923e-01 1.610584e+00
#&gt; 187  68   0     1     1 1.537788e-06 4.085727e-06
#&gt; 188  48   1     0     0 2.275831e+00 6.046622e+00
#&gt; 189  75   1     1     0 3.506458e-11 9.316259e-11
#&gt; 190  50   0     1     0 6.357274e-01 1.689055e+00
#&gt; 191  75   1     0     1 6.719634e-11 1.785330e-10
#&gt; 192  59   1     1     0 3.392896e-02 9.014537e-02
#&gt; 193  48   0     1     0 6.283238e-01 1.669385e+00
#&gt; 194  62   1     0     1 5.487708e-03 1.458021e-02
#&gt; 195  70   0     0     0 1.828585e-07 4.858340e-07
#&gt; 196  56   1     1     0 2.099675e-01 5.578596e-01
#&gt; 197  46   0     1     1 4.436790e-01 1.178804e+00
#&gt; 198  67   1     1     1 1.047111e-05 2.782053e-05</div><div class='input'>
<span class='co'># Each of the wt_diagnostics outputs can also be estimated individually</span>
<span class='no'>ESS</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='estimate_ess.html'>estimate_ess</a></span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>)
<span class='no'>weight_summ</span> <span class='kw'>&lt;-</span> <span class='fu'>summarize_wts</span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>)
<span class='no'>wts_profile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='profile_wts.html'>profile_wts</a></span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>, <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>match_cov</span>)

<span class='co'># Plot histograms of unscaled and rescaled weights</span>
<span class='co'># bin_width needs to be adapted depending on the sample size in the data set</span>
<span class='no'>histogram</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='hist_wts.html'>hist_wts</a></span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>, <span class='kw'>bin</span> <span class='kw'>=</span> <span class='fl'>50</span>)
<span class='no'>histogram</span></div><div class='img'><img src='summarize_wts-1.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Has the optimization worked? -------------------------------------------------</span>

<span class='co'># The following code produces a summary table of the intervention baseline</span>
<span class='co'># characteristics before and after matching compared with the comparator</span>
<span class='co'># baseline characteristics:</span>

<span class='co'># Create an object to hold the output</span>
<span class='no'>baseline_summary</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>'Intervention'</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
                         <span class='st'>'Intervention_weighted'</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
                         <span class='st'>'Comparator'</span> <span class='kw'>=</span> <span class='fl'>NA</span>)

<span class='co'># Summarise matching variables for weighted intervention data</span>
<span class='no'>baseline_summary</span>$<span class='no'>Intervention_weighted</span> <span class='kw'>&lt;-</span> <span class='no'>est_weights</span>$<span class='no'>analysis_data</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span>(<span class='no'>AGE</span>, <span class='no'>SEX</span>, <span class='no'>SMOKE</span>, <span class='no'>ECOG0</span>, <span class='no'>wt</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise_all.html'>summarise_at</a></span>(<span class='no'>match_cov</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(~ <span class='fu'><a href='https://rdrr.io/r/stats/weighted.mean.html'>weighted.mean</a></span>(<span class='no'>.</span>, <span class='no'>wt</span>)))

<span class='co'># Summarise matching variables for unweighted intervention data</span>
<span class='no'>baseline_summary</span>$<span class='no'>Intervention</span> <span class='kw'>&lt;-</span> <span class='no'>est_weights</span>$<span class='no'>analysis_data</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span>(<span class='no'>AGE</span>, <span class='no'>SEX</span>, <span class='no'>SMOKE</span>, <span class='no'>ECOG0</span>, <span class='no'>wt</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise_all.html'>summarise_at</a></span>(<span class='no'>match_cov</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(~ <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>.</span>)))

<span class='co'># baseline data for the comparator study</span>
<span class='no'>baseline_summary</span>$<span class='no'>Comparator</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span>(<span class='no'>target_pop_standard</span>,
                                         <span class='no'>AGE</span>,
                                         <span class='no'>SEX</span>,
                                         <span class='no'>SMOKE</span>,
                                         <span class='no'>ECOG0</span>)

<span class='co'># Combine the three summaries</span>
<span class='co'># Takes a list of data frames and binds these together</span>
<span class='no'>trt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>baseline_summary</span>)
<span class='no'>baseline_summary</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span>(<span class='no'>baseline_summary</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>transmute_all</a></span>(<span class='no'>sprintf</span>, <span class='kw'>fmt</span> <span class='kw'>=</span> <span class='st'>"%.2f"</span>) <span class='kw'>%&gt;%</span> <span class='co'>#apply rounding for presentation</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span>(<span class='kw'>ARM</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>trt</span>), <span class='no'>AGE</span>, <span class='no'>SEX</span>, <span class='no'>SMOKE</span>, <span class='no'>ECOG0</span>)

<span class='co'># Insert N of intervention  as number of patients</span>
<span class='no'>baseline_summary</span>$<span class='no'>`N/ESS`</span>[<span class='no'>baseline_summary</span>$<span class='no'>ARM</span> <span class='kw'>==</span> <span class='st'>"Intervention"</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>est_weights</span>$<span class='no'>analysis_data</span>)

<span class='co'># Insert N for comparator from target_pop_standard</span>
<span class='no'>baseline_summary</span>$<span class='no'>`N/ESS`</span>[<span class='no'>baseline_summary</span>$<span class='no'>ARM</span> <span class='kw'>==</span> <span class='st'>"Comparator"</span>] <span class='kw'>&lt;-</span> <span class='no'>target_pop_standard</span>$<span class='no'>N</span>

<span class='co'># Insert the ESS as the sample size for the weighted data</span>
<span class='co'># This is calculated above but can also be obtained using the estimate_ess function as shown below</span>
<span class='no'>baseline_summary</span>$<span class='no'>`N/ESS`</span>[<span class='no'>baseline_summary</span>$<span class='no'>ARM</span> <span class='kw'>==</span> <span class='st'>"Intervention_weighted"</span>] <span class='kw'>&lt;-</span> <span class='no'>est_weights</span>$<span class='no'>analysis_data</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='estimate_ess.html'>estimate_ess</a></span>(<span class='kw'>wt_col</span> <span class='kw'>=</span> <span class='st'>'wt'</span>)

<span class='no'>baseline_summary</span> <span class='kw'>&lt;-</span> <span class='no'>baseline_summary</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span>(<span class='no'>ARM</span>, <span class='kw'>`N/ESS`</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>`N/ESS`</span>,<span class='fl'>1</span>), <span class='no'>AGE</span>, <span class='no'>SEX</span>, <span class='no'>SMOKE</span>, <span class='no'>ECOG0</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


